(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{340:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var r=a(22),n=a.n(r),o=a(35),i=a(32),s=a(33),c=a(341),l=a.n(c),u=a(95),h=a(10),p=["http://serverlab2016.eastus2.cloudapp.azure.com:8800/api/cloud/","".concat(window.location.origin,"/api/cloud/")],d=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"getCriterias",value:function(){var e=Object(o.a)(n.a.mark(function e(){var t,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.urlApi).concat(this.criteriaController),e.next=3,this.httpClient(t,"GET");case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createCriteria",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.criteriaController),e.next=3,this.httpClient(a,"POST",t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateCriteria",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.criteriaController),e.next=3,this.httpClient(a,"PUT",t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCriteria",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.criteriaController,"/").concat(t),e.next=3,this.httpClient(a,"DELETE");case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCharges",value:function(){var e=Object(o.a)(n.a.mark(function e(){var t,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.urlApi).concat(this.chargesController),e.next=3,this.httpClient(t,"GET");case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createCharge",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.chargesController),e.next=3,this.httpClient(a,"POST",t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateCharge",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.chargesController),e.next=3,this.httpClient(a,"PUT",t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCharge",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.chargesController,"/").concat(t),e.next=3,this.httpClient(a,"DELETE");case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getResult",value:function(){var e=Object(o.a)(n.a.mark(function e(){var t,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.urlApi).concat(this.resultController),e.next=3,this.httpClient(t,"GET");case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"saveResult",value:function(){var e=Object(o.a)(n.a.mark(function e(t){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.urlApi).concat(this.resultController),e.next=3,this.httpClient(a,"POST",t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getToken",value:function(){var e=Object(o.a)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.getAccessToken();case 2:if(this.token=e.sent,h.a.isNullOrUndefined(this.token)){e.next=7;break}return e.abrupt("return",this.token.accessToken);case 7:return e.abrupt("return","");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"httpClient",value:function(){var e=Object(o.a)(n.a.mark(function e(t,a,r){var i=this;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(o.a)(n.a.mark(function e(o){var s,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getToken();case 2:s=e.sent,c={"App-ID":u.b.tenatId,Authorization:"Bearer "+s,"Content-Type":"application/json","Cache-Control":"no-cache"},l()({method:a,url:t,data:r,headers:c}).then(function(e){200===e.status?o(e.data):o({Exito:!1,Message:"Error procesando la solicitud. "+e.request.responseText})}).catch(function(e){"Network Error"===e.message?o({Exito:!1,Message:"Ha ocurrido un error en el env\xedo de la solicitud, se encontr\xf3 problemas de conexi\xf3n con el servicio."}):h.a.isNullOrUndefined(e.response)||401!==e.response.status?h.a.isNullOrUndefined(e.response)||404!==e.response.status?o({Exito:!1,Message:"Ha ocurrido un error en procesamiento de la solicitud sobre el servicio.",Error:e}):o({Exito:!1,Message:"No se encontr\xf3 la url de la petici\xf3n solicitada, por favor verifiqu\xe9 los par\xe1metros del servicio.",Error:e}):o({Exito:!1,Message:"Autenticaci\xf3n no valida, debe iniciar sesi\xf3n para continuar usando el sistema."})});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t,a,r){return e.apply(this,arguments)}}()}]),e}();d.urlApi=p[1],d.criteriaController="criteria",d.chargesController="charges",d.resultController="result",d.token=void 0},382:function(e,t,a){"use strict";a.r(t);var r=a(22),n=a.n(r),o=a(35),i=a(32),s=a(33),c=a(43),l=a(42),u=a(9),h=a(44),p=a(1),d=a.n(p),f=a(383),v=a(384),m=a(385),g=a(386),b=a(387),C=a(388),x=a(389),E=a(390),y=a(335),k=a(10),O=a(340),w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).optionResult=void 0,a.criteriaList=[],a.chargesList=[],a.optionGo=void 0,a.dt=void 0,a.loadComponent=!1,a.state={dataList:[],chargesResult:[]},a.optionResult=[{label:"Bajo",value:1,color:"red"},{label:"Medio",value:2,color:"yellow"},{label:"Alto",value:3,color:"green"}],a.optionGo=[{label:"NOT GO",value:0,color:"red"},{label:"GO",value:1,color:"green"}],a.loadData=a.loadData.bind(Object(u.a)(a)),a.generateDataResult=a.generateDataResult.bind(Object(u.a)(a)),a.formSelectOnChange=a.formSelectOnChange.bind(Object(u.a)(a)),a.formSelectChargesOnChange=a.formSelectChargesOnChange.bind(Object(u.a)(a)),a.onChangesColorCell=a.onChangesColorCell.bind(Object(u.a)(a)),a.onSave=a.onSave.bind(Object(u.a)(a)),a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.loadComponent=!0,this.loadData()}},{key:"componentWillUnmount",value:function(){this.loadComponent=!1}},{key:"loadData",value:function(){var e=Object(o.a)(n.a.mark(function e(){var t=this;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:k.a.loader(!0),O.a.getCriterias().then(function(e){if(e&&!0===e.Exito)t.criteriaList=e.Values||[],t.generateDataResult();else{if(k.a.dialogBox("",e.Message,"info",e.Error),!t.loadComponent)return;k.a.loader(!1)}}),O.a.getCharges().then(function(e){if(e&&!0===e.Exito)t.chargesList=e.Values||[],t.generateDataResult();else{if(k.a.dialogBox("",e.Message,"info",e.Error),!t.loadComponent)return;k.a.loader(!1)}});case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"generateDataResult",value:function(){var e=Object(o.a)(n.a.mark(function e(){var t,a,r,o=this;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadComponent){e.next=2;break}return e.abrupt("return");case 2:if(t=[],a=[],!(this.criteriaList.length>0&&this.chargesList.length>0)){e.next=21;break}return e.next=8,O.a.getResult();case 8:if(r=e.sent,(k.a.isNullOrUndefined(r)||k.a.isNullOrUndefined(r.Values))&&(r={Values:[]}),this.criteriaList.forEach(function(e){var a=[];o.chargesList.forEach(function(t){var n="",i=0,s=r.Values.find(function(a){return a.IdCharges===t.Id&&a.IdCriteria===e.Id});k.a.isNullOrUndefined(s)||(n=s.Id,i=s.Value),a.push({Id:n,IdCharges:t.Id,IdCriteria:e.Id,IdCell:"".concat(e.Id,"-").concat(t.Id),Value:i,OriginalValue:i,OptionValue:o.optionResult.find(function(e){return e.value===i})})}),t.push({IdCriteria:e.Id,CriteriaName:e.Name,Weight:e.Weight,TypeAnalysis:e.TypeAnalysis,TypeAnalysisName:k.a.getTypeAnalysisName(e.TypeAnalysis),Result:a})}),this.chargesList.forEach(function(e){e.OriginalGo=e.Go;var t=k.a.clone(e);k.a.isNullOrUndefined(t.Go)&&(t.Go=-1),a.push(t)}),this.loadComponent){e.next=14;break}return e.abrupt("return");case 14:return e.next=17,this.setState({dataList:t,chargesResult:a});case 17:k.a.dataTable(this.dt,{scrollX:!0,scrollY:"60vh",scrollCollapse:!0,paging:!1,order:[],fixedColumns:{leftColumns:window.outerWidth>800?3:1}}),k.a.loader(!1),e.next=21;break;case 21:if(this.loadComponent){e.next=23;break}return e.abrupt("return");case 23:k.a.loader(!1);case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"formSelectOnChange",value:function(){var e=Object(o.a)(n.a.mark(function e(t,a,r){var o,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.target.value,!k.a.isNullOrUndefined(o)&&0!==parseInt(o)){e.next=3;break}return e.abrupt("return");case 3:return i=this.state.dataList,r>=0&&(i[a].Result[r].Value=parseInt(o)),e.next=7,this.setState({dataList:i});case 7:case"end":return e.stop()}},e,this)}));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"formSelectChargesOnChange",value:function(){var e=Object(o.a)(n.a.mark(function e(t,a){var r,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target.value,!k.a.isNullOrUndefined(r)&&-1!==parseInt(r)){e.next=3;break}return e.abrupt("return");case 3:return o=this.state.chargesResult,a>=0&&(o[a].Go=parseInt(r)),e.next=7,this.setState({chargesResult:o});case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"onSave",value:function(){var e=Object(o.a)(n.a.mark(function e(){var t,a,r,o,i,s,c,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.dataList,a=this.state.chargesResult,!k.a.isNullOrUndefined(t)&&0!==t.length){e.next=4;break}return e.abrupt("return");case 4:if(k.a.loader(!0),r=[],t.forEach(function(e){e.Result.forEach(function(e){e.Value>0&&e.Value!==e.OriginalValue&&r.push({Id:e.Id,IdCharges:e.IdCharges,IdCriteria:e.IdCriteria,Value:e.Value})})}),o=[],a.forEach(function(e){e.Go>-1&&e.Go!==e.OriginalGo&&o.push(e)}),!k.a.isNullOrUndefined(r)&&0!==r.length||!k.a.isNullOrUndefined(o)&&0!==o.length){e.next=13;break}return k.a.dialogBox("","No se encontr\xf3 cambios que deben ser almacenados","info"),k.a.loader(!1),e.abrupt("return");case 13:return i={Result:r,Charges:o},e.next=16,O.a.saveResult(i);case 16:if(!0!==(s=e.sent).Exito){e.next=26;break}return c=s.Message,r.length>0&&t.forEach(function(e){e.Result.forEach(function(e){e.OriginalValue=e.Value})}),o.length>0&&(k.a.isNullOrUndefined(s.Values.charges)||!0!==s.Values.charges.Exito?(c=d.a.createElement("div",null,d.a.createElement("span",null,"Proceso ejecutado con novedades"),d.a.createElement("br",null),d.a.createElement("p",{style:{color:"darkred"}},d.a.createElement("b",null,"No fue posible actualizar los datos asociados a las cargas (GO o NOT GO), por favor int\xe9ntelo nuevamente."))),l=s.Values.charges.Error):a.forEach(function(e){e.OriginalGo=e.Go})),k.a.dialogBox("",c,"info",l),e.next=24,this.setState({dataList:t,chargesResult:a});case 24:e.next=27;break;case 26:k.a.dialogBox("",s.Message,"info",s.Error);case 27:k.a.loader(!1);case 28:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onChangesColorCell",value:function(e,t){var a;if(!k.a.isNullOrUndefined(e))if("cell"===t){if(a=this.optionResult.find(function(t){return t.value===e}),!k.a.isNullOrUndefined(a))return a.color}else if("footer"===t&&(a=this.optionGo.find(function(t){return t.value===e}),!k.a.isNullOrUndefined(a)))return a.color;return""}},{key:"render",value:function(){var e=this,t=this.state,a=t.dataList,r=t.chargesResult;return d.a.createElement("div",{className:"animated fadeIn"},d.a.createElement(f.a,{style:{marginTop:"20px"}},d.a.createElement(v.a,{xs:"12"},d.a.createElement(m.a,null,d.a.createElement(g.a,null,d.a.createElement("strong",null,"Informaci\xf3n GOoNoTGO")),d.a.createElement(b.a,null,d.a.createElement(C.a,{className:"tabletable table-no-margin-bottom",style:{fontSize:"14px"},innerRef:function(t){return e.dt=t},hover:!0,bordered:!0,striped:!0,size:"sm"},d.a.createElement("thead",{className:"tableHead"},d.a.createElement("tr",null,d.a.createElement("th",{style:{minWidth:window.outerWidth>800?"200px":"100px"},"data-orderable":"false"},"Criterios Base"),d.a.createElement("th",{style:{width:"90px"},"data-orderable":"false"},"Peso"),d.a.createElement("th",{style:{width:"90px"},"data-orderable":"false"},"Genero"),this.chargesList.map(function(e){return d.a.createElement("th",{key:"cell-".concat(e.Id),style:{width:"120px"},"data-id":e.Id,"data-orderable":"false"},e.Name)}))),d.a.createElement("tbody",null,a.map(function(t,a){return d.a.createElement("tr",{key:t.IdCriteria,"data-row":t.IdCriteria,style:{backgroundColor:"white"}},d.a.createElement("td",{className:"padding-cell"},t.CriteriaName),d.a.createElement("td",{className:"padding-cell"},"".concat(t.Weight," %")),d.a.createElement("td",{className:"padding-cell"},t.TypeAnalysisName),e.chargesList.map(function(r,n){var o="".concat(t.IdCriteria,"-").concat(r.Id);return d.a.createElement("td",{key:"ct-".concat(o),"data-id":o,style:{width:"120px",backgroundColor:e.onChangesColorCell(t.Result[n].Value,"cell")}},d.a.createElement(x.a,{type:"select",className:"no-border-select","data-cell":o,value:t.Result[n].Value,onChange:function(t){return e.formSelectOnChange(t,a,n)}},d.a.createElement("option",{value:0}),e.optionResult.map(function(e){return d.a.createElement("option",{key:"opt_go_".concat(e.value),value:e.value},e.label)})))}))})),d.a.createElement("tfoot",null,d.a.createElement("tr",null,d.a.createElement("th",null),d.a.createElement("th",null),d.a.createElement("th",null),r.map(function(t,a){return d.a.createElement("th",{key:"cell-footer-".concat(t.Id),style:{width:"120px",backgroundColor:e.onChangesColorCell(t.Go,"footer")},"data-id":t.Id,"data-orderable":"false"},d.a.createElement(x.a,{type:"select",className:"no-border-select",value:t.Go,onChange:function(t){return e.formSelectChargesOnChange(t,a)}},d.a.createElement("option",{value:-1},"Estado..."),e.optionGo.map(function(e){return d.a.createElement("option",{key:"opt_go_".concat(e.value),value:e.value},e.label)})))}))))),d.a.createElement(E.a,{className:"text-right"},d.a.createElement(y.a,{type:"button",color:"primary",onClick:this.onSave},"Guardar"))))))}}]),t}(d.a.Component);t.default=w}}]);